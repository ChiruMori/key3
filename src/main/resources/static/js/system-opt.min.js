/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2020 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

$(document).ready(function(){const t=$("#runtimeBtn"),n=$("#smtpBtn"),o=$("#primaryBtn"),e=$("#smtpTestBtn");var i="admin/api/options";let s;function r(n){utils.showLoading(),n.week_start_stamp&&(n.week_start_stamp=new Date(n.week_start_stamp).getTime()),utils.ajax(i+"/map_view",n,"PUT",function(){for(var t in n)n.hasOwnProperty(t)&&(s[t]=n[t]);a()},function(t){utils.error("ERROR",t.responseJSON.msg),console.debug(t)},utils.hideLoading)}t.on("click",function(){var t=utils.formToObj("runtimeForm");r(t)}),n.on("click",function(){var t=utils.formToObj("smtpForm");r(t)}),o.on("click",function(){var t=utils.formToObj("primaryForm");r(t)}),e.on("click",function(){utils.prompt("测试邮件配置","注意，请在提交后进行测试。请输入要接受测试邮件的邮箱地址","email","如：eg@eg.com").then(function(t){t?utils.ajax(i+"/mail_test?addr="+t,{},"POST",function(t){utils.success("SUCCESS",t.msg)},function(t){console.debug(t),utils.error("ERROR",t.responseJSON.msg)}):utils.alert("您取消了操作")})});const a=function(){for(var t in s)s.hasOwnProperty(t)&&("week_start_stamp"===t?$("#"+t).val(function(t){let n=new Date(t),o="";o+=n.getFullYear(),o+="-";t=n.getMonth()+1;t<10&&(o+="0"+t);t=n.getDate();return o+="-",t<10&&(o+="0"+t),o}(s[t])):$("#"+t).val(s[t]))};utils.showLoading(),utils.ajax(i+"/map_view",{},"GET",function(t){s=t.data,a()},function(t){utils.error("ERROR",t.responseJSON.msg),console.debug(t)},utils.hideLoading)});