/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2021 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

$().ready(function(){function t(e){utils.writeCache(CONST_VAL.tokenTime,(new Date).getTime()+1e3*Number(e.expired_in)),utils.writeCache(CONST_VAL.tokenKey,e.access_token),utils.writeCache(CONST_VAL.refreshKey,e.refresh_token),window.location.href="/key3/admin/page/dashboard?admin_token_Authorization="+e.access_token}var e="/admin/api/refresh/"+utils.readCache(CONST_VAL.refreshKey);utils.ajax(e,null,"POST",function(e){t(e.data)},function(){console.error("Token 已过期，自动登录失败，需要手动登录")});const n=$("#loginBtn"),o=$("#errMsgDiv"),i=$("#maintainBtn");let a;n.click(function(){a=utils.formToObj("loginForm"),utils.ajax("admin/api/login",a,"POST",function(e){t(e.data)},function(e){let t=e.responseJSON;for(var n in o.text(t.msg),t.data)t.data.hasOwnProperty(n)&&($("#"+n+"Hint").text(t.data[n]),delete a[n]);for(var i in a)a.hasOwnProperty(i)&&$("#"+i+"Hint").text("")})}),i.on("click",function(){a=utils.formToObj("loginForm"),location.href="/key3/kit/page/kit-index?uid="+a.studentNo+"&openId="+a.passcode})});