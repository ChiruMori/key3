/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2020 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

const CONST_VAL={tokenKey:'accessToken',refreshKey:'refreshToken',tokenTime:'accessEndTime',tokenQueryName:'admin_token_Authorization',tokenHeaderName:'ADMIN-Authorization',managingClubKey:'managing_club',clubChangedEventKey:'club_changed',newClubLockKey:'new_club_lock'};(function($){"use strict";$("#sidebarToggle, #sidebarToggleTop").on('click',function(e){$("body").toggleClass("sidebar-toggled");$(".sidebar").toggleClass("toggled");if($(".sidebar").hasClass("toggled")){$('.sidebar .collapse').collapse('hide')}});$(window).resize(function(){if($(window).width()<768){$('.sidebar .collapse').collapse('hide')}if($(window).width()<480&&!$(".sidebar").hasClass("toggled")){$("body").addClass("sidebar-toggled");$(".sidebar").addClass("toggled");$('.sidebar .collapse').collapse('hide')}});$('body.fixed-nav .sidebar').on('mousewheel DOMMouseScroll wheel',function(e){if($(window).width()>768){var e0=e.originalEvent,delta=e0.wheelDelta||-e0.detail;this.scrollTop+=(delta<0?1:-1)*30;e.preventDefault()}});$(document).on('scroll',function(){var scrollDistance=$(this).scrollTop();if(scrollDistance>100){$('.scroll-to-top').fadeIn()}else{$('.scroll-to-top').fadeOut()}});$(document).on('click','a.scroll-to-top',function(e){var $anchor=$(this);$('html, body').stop().animate({scrollTop:($($anchor.attr('href')).offset().top)},1000,'easeInOutExpo');e.preventDefault()})})(jQuery);let utils=(function(){const formToObj=function(formId){let formObj={};let arr=$('#'+formId).serializeArray();$.each(arr,function(){if(formObj[this.name]){formObj[this.name]=[formObj[this.name],this.value];return}formObj[this.name]=this.value});return formObj};const server="/key3/";const parseParam=function(obj,key){let paramStr="";let objType=typeof obj;if(objType==='string'||objType==='number'||objType==='boolean'){paramStr+="&"+key+"="+encodeURIComponent(obj)}else{$.each(obj,function(i,v){let k=key==null?i:key+(obj instanceof Array?"["+i+"]":"."+i);paramStr+='&'+parseParam(v,k)})}return paramStr.substr(1)};const ajax=function(url,data,method,successFn,failFn,complete,uploadFile=false){if(!complete)complete=function(){};if(method==='GET'||method==='DELETE'){let connector=/\?.+=/.test(url)?'&':'?';let paramParsed=parseParam(data);if(paramParsed){url=url+connector+parseParam(data)}data=''}else if(!uploadFile){data=JSON.stringify(data)}let tokenHeaders={};let cachedAccessToken=readCache(CONST_VAL.tokenKey);if(cachedAccessToken){tokenHeaders[CONST_VAL.tokenHeaderName]=cachedAccessToken}$.ajax({url:server+url,type:method,data:data,dataType:'json',headers:tokenHeaders,contentType:uploadFile?false:'application/json;charset=utf-8',processData:uploadFile?false:undefined,success:function(res){successFn(res)},error:function(res){failFn(res)},complete:function(res){complete(res)}})};const readCache=function(key){return JSON.parse(localStorage.getItem(key))};const removeCache=function(key){localStorage.removeItem(key)};const writeCache=function(key,val){localStorage.setItem(key,JSON.stringify(val))};const simpleEventCenter={};const listeners={};const publishEvent=function(type,event){if(typeof listeners[type]==='function'){listeners[type](event);return}simpleEventCenter[type]=event};const subscribeEvent=function(type,fn){if(typeof fn!=='function'){delete listeners[type]}listeners[type]=fn;if(simpleEventCenter[type]){fn(simpleEventCenter[type]);delete simpleEventCenter[type]}};let loadingShowing=false;return{formToObj:formToObj,ajax:ajax,readCache:readCache,writeCache:writeCache,removeCache:removeCache,publishEvent:publishEvent,subscribeEvent:subscribeEvent,showLoading:function(text){if(loadingShowing){throw'加载层已在显示中，不能重复打开';}loadingShowing=true;if(!text){text='LOADING...'}$('#loadingLayer').fadeIn();$('#loadingText').text(text)},hideLoading:function(){if(!loadingShowing){throw'加载层尚未显示，无法关闭';}loadingShowing=false;$('#loadingLayer').fadeOut()},whenIs:function(targetDate){if(targetDate.constructor===Date){targetDate=targetDate.getTime()}let timeDiff=(new Date().getTime()-targetDate)/1000;if(timeDiff>31104000){return~~(timeDiff/31104000)+'年前'}if(timeDiff>2592000){return~~(timeDiff/2592000)+'个月前'}if(timeDiff>86400*2){return~~(timeDiff/86400)+'天前'}if(timeDiff>86400){return'昨天'}if(timeDiff>3600){return~~(timeDiff/3600)+'小时前'}if(timeDiff>60){return~~(timeDiff/60)+'分钟前'}return'刚刚'},wrapUrlWithToken:function(url){let connector=/\?.+=/.test(url)?'&':'?';return url+connector+CONST_VAL.tokenQueryName+'='+readCache(CONST_VAL.tokenKey)},alert:function(msg){return swal(msg)},success:function(title,msg){return swal(title,msg,'success')},warning:function(title,msg){return swal(title,msg,'warning')},error:function(title,msg){return swal(title,msg,'error')},confirm:function(title,msg,okBtn,cancelBtn){return swal({title:title,text:msg,buttons:{cancel:{text:cancelBtn,className:'btn btn-danger',closeModal:true,value:false,visible:true,},confirm:{text:okBtn,className:'btn btn-primary',closeModal:true,value:true,visible:true,}}})},prompt:function(title,msg,type,placeholder){return new Promise(function(res){let inp=document.createElement('input');if(!placeholder){placeholder=''}if(!type){type='text'}inp.setAttribute('type',type);swal({title:title,text:msg,content:{element:"input",attributes:{placeholder:placeholder,type:type,},},}).then(function(str){res(str)})})},select:function(title,msg,options,selectClass,defaultText){let selectTag=document.createElement('select');selectTag.className=selectClass;let defaultOpt=document.createElement('option');defaultOpt.setAttribute('disabled',true);defaultOpt.text=defaultText;selectTag.append(defaultOpt);options.forEach(function(opt){let optTag=document.createElement('option');optTag.text=opt.text;optTag.value=opt.value;selectTag.append(optTag)});selectTag.onchange=function(){swal.setActionValue(selectTag.value)};return swal({title:title,text:msg,content:selectTag})}}})();