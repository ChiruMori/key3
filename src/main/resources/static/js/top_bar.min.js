/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2020 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

const GLOBAL_VAL={nowClubId:null,systemAdmin:!1};$().ready(function(){const t=$("#now-club-name"),e=$("#newClubBtn");let n=utils.readCache(CONST_VAL.managingClubKey);$("#logoutBtn").click(function(){utils.ajax("admin/api/logout",{},"GET",function(){utils.removeCache(CONST_VAL.tokenTime),utils.removeCache(CONST_VAL.tokenKey),utils.removeCache(CONST_VAL.refreshKey),window.location.href="/key3/admin/page/login"},function(e){console.error(e),alert("登出失败，请重试")})}),e[0]&&e.click(function(){utils.writeCache(CONST_VAL.newClubLockKey,!0),window.location.href="/key3/admin/page/club-info?"+CONST_VAL.tokenQueryName+"="+utils.readCache(CONST_VAL.tokenKey)});function i(e){e||utils.alert("社团无效，如果您正在初始化系统，请新建一个社团。如果不是，请联系系统管理员报告问题"),t.text(e.name),GLOBAL_VAL.nowClubId=e.id,n=e,utils.writeCache(CONST_VAL.managingClubKey,e),utils.publishEvent(CONST_VAL.clubChangedEventKey,e)}if(!n){let e=$(".club-item");n={id:e[0].getAttribute("itemId"),name:e[0].textContent},utils.writeCache(CONST_VAL.managingClubKey,n)}i(n),$("a.dropdown-item.d-flex").click(function(){let e=$(this).find(".club-item");var t={id:e.attr("itemId"),name:e.text()};t.id!==n.id&&i(t)})});