
### 日志

**2020.10.27**

+ 开始、确定基本程序结构
+ 简单的程序设计
+ Email 功能完成

- - -

**2020.10.28**

+ 决定为本程序建立仓库
+ 日志、验证功能
+ 事件发布、订阅

- - -

**2020.11.1**

+ 缓存模块
+ 全局配置（MyFontProperties 部分功能）

**2020.11.8~9**

+ 项目迁移
+ 缓存模块基本完成
+ 登录凭证、安全上下文
+ 全局配置项功能模块（及相关的工具类、实体类等）

**2020.11.13**

+ 全局配置项
+ 邮件功能模块重写

**2020.11.14~15**

+ AdminController
+ UserController
+ core 包、全局异常处理、全局 Controller 日志
+ 登录模块（未测试）含登录验证即相关部分
+ 系统安装、初始化模块（未测试）
+ 配置使用 Swagger2 API 文档（修正版本无法显示的 BUG）
+ 全局响应、全局异常处理、Json 序列化、全局 MVC 配置
+ 创建开发环境配置文件

- - -

**2020.11.16**

+ 剔除无关代码、重命名可复用的类
+ 建库（课设相关部分）

**2020.11.17**

+ 程序基础模块完善
+ 用户模块（API 接口）：用户更新、用户登录功能

**2020.11.18**

+ 用户模块（API 接口）：社团用户列表（及分页）
+ 用户模块（API 接口）：（用户列表、用户信息展示）
+ 修改用户表，添加用户角色字段，方便管理员功能开发
+ 遗留数据迁移
+ 测试接口时发现重大 BUG

**2020.11.19**

+ 编写开发文档（dev.md），记录关键模块的原理与思路
+ 系统基础模块：全局过滤器、用户登录状态拦截器，废弃 OpenIdUser 方案取得用户凭证，改用 SecurityContext 方案

**2020.11.20**

+ 修改用户登录方案，ThreadLocal（过滤器拦截用户 Token，验证并写入） + Token + 缓存，取代 Session
+ 更新用户信息时表单字段分组验证
+ 修复 BUG: 实体类上的枚举类型无法与数据库进行映射
+ 修复 BUG: 用户登录后，登录状态失效（OpenId 传递过程中丢失）
+ 修复 BUG: 联合主键查询不到数据
+ 修复 BUG: 查询用户信息列表错误（无用户、分页数量错误）

**2020.11.21**

+ 管理员模块：管理员登录凭证的生成与校验
+ 管理员模块：修改用户授权（分级权限管理）
+ 管理员模块：新增社团成员

**2020.11.22**

+ 管理员模块：用户信息增删改查
+ 解决问题：循环依赖，构造注入改为 setter 注入
+ 修改设计：用户学号修改为 Long 类型，并设置为唯一键
+ 修复 BUG：因用户学号字段数据类型修改导致的类型转换问题
+ 修复 BUG：管理员登录后提示未登录（Token 前缀设置错误）
+ 修复 BUG：管理员修改授权

**2020.11.23~25**

+ Start Bootstrap 管理后台的前端页面雏形
+ 将写好的模板页拆分成 ftl 碎片
+ 管理员登录页面的前后端打通

**2020.11.26**

+ 管理后台：仪表盘主要功能完成，前后端打通（数据统计、系统日志、社团收支、加载层、简易事件分发中心以及相关的工具函数）

**2020.11.28**

+ 管理后台：社团信息维护功能完成（社团信息的 CRUD）

**2020.11.29**

+ 前端整合 DataTables（Alt-Editor、buttons、responsive、select、汉化）
+ 管理后台：社团财务信息维护（账单信息 Bill 的 CRUD）

**2020.11.30**

+ 管理后台：社团系统日志查看、社团成员管理界面设计

**2020.12.1**

+ 全局配置：在 Filter 层、Servlet 层中间增加 Emoji 转化工具
+ 管理后台：社团成员基本信息维护（CRUD）

**2020.12.2~3**

+ 管理后台：社团成员基本信息、社团关系信息（CRUD）完成、BUG 修复。
+ 合并预约模块部分代码，修复错误页面 BUG

**2020.12.4**

+ 分析剩余模块功能、设计
+ 管理后台，活动室、预约管理页面设计

**2020.12.5**

+ 管理后台，活动室管理模块（Room、Belong）

**2020.12.6~7**

+ 修复 BUG: 管理员活动室管理页面，正确填写表单后提示错误
+ 修复 BUG: 管理员活动室管理页面，新建创建活动室时，删除按钮可见
+ 修改：新增字段导致已有模块的变化
+ 整理代码
+ 增加 DateUtils ，以指针方式操作日期，并完成测试
+ 用户预约功能实现

**2020.12.8**

+ 引入 Bootstrap-Sweetalert 留下一些 Bug （管理员功能页面，受影响部分，未调试）
+ 废弃 Bootstrap-Sweetalert 文档受限，难于拓展，引入 sweetalert2 并封装

**2020.12.9**

+ 废弃 YUI 压缩，采用手动压缩
+ 管理后台：预约模块完成
+ 管理后台：系统参数模块完成
+ 邮件模块测试通过

**2020.12.10~12**

+ 重新设计通知模块（废弃微信通知方案）
+ 重新设计小程序页面
+ 完成通知模块基础构建（不包含接口）

### TODO

+ 基础功能收尾
    + 通知模块（通知类型、全局通知事件监听、定时任务设置）
    + 日志模块整理（在哪里发送日志）
    + 公告模块（后台管理页面、CRUD）
+ 分功能模块开发
    + 预约模块（关注时间段、签到限制）
    + 通知公告模块（管理员发公告、用户接受通知、预约可用通知、通知开关）
    + 活动管理模块（管理员举办活动、用户参与活动、贡献点数核算等）
+ 测试增强
    + 补充全部模块的单元测试
    + 压力测试
+ 架构增强
    + 集群架构方案（SpringCloud, Docker）

### BUGS

+ Redis 缓存因未知问题（疑似配置问题）导致无法使用

#### FIXED

+ 仪表盘动画效果异常，相同代码生成的静态 HTML 文件直接加载并不能重现这个问题，css 压缩插件导致的问题
+ 数据从数据库中查出来后，传递到前端丢失。原因：DTO 对象未正确设置 getter、setter 导致数据不对外公开
+ 新建社团时，传入的初始经费被忽略，直接为零。Club 的初始化方法中需要加一个判空条件
+ Alt-Editor BUGS、功能拓展
    + 编辑用户基本信息时，打开管理员用户的编辑后，管理员选项并未选中。alt-editor 并不会调用 render 方法，拓展方法解决。
    + 设置了 readonly 的字段，无论执行什么操作都无法修改。alt-editor 并不支持分操作只读，拓展方法解决。

### 功能增强

+ 小程序页面卸载时，调用 logout 释放后端资源（使用 token 方案替代即可）
